<script> location="" </script><!DOCTYPE html><html lang="en"><head><title>修改密码</title><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0,user-scalable=no, minimum-scale=1.0, maximum-scale=1.0"><meta name='apple-mobile-web-app-capable' content='yes'><meta name='full-screen' content='true'><meta name='x5-fullscreen' content='true'><meta name='360-fullscreen' content='true'><link rel="stylesheet" href="static/css/style.css"><link rel="stylesheet" href="static/css/toast.css"><link rel="stylesheet" href="static/css/loading.css"><link rel="stylesheet" href="static/css/public.css"><link href="static/css/docco.min.css" rel="stylesheet"><script src="static/js/highlight.min.js"></script><script src="static/js/fastclick.js"></script><!--<script type="text/javascript" src="/static/js/message.js"></script>--><script src="static/js/jquery.min.js"></script><script type="text/javascript" src="static/js/jquery.cookie.js"></script><script type="text/javascript" src="static/js/toast.js"></script><script type="text/javascript" src="static/js/loading.js"></script><script type="text/javascript" src="static/js/dialog.min.js"></script><script type="text/javascript" src="static/js/layer.js"></script><!--实名弹窗--><script type="text/javascript" src="static/js/hsycmsAlert.js"></script><!--实名弹窗--><!--消息弹窗--><div class="alert_windows1" onclick="xiaoxi_close()"><span id="xiaoxi_tan"></span></div><div class="alert_windows2" onclick="tongzhi_close()"><span id="tongzhi_tan"></span></div><div class="hsycms-model-mask" id="mask-alert"></div><div class="hsycms-model hsycms-model-alert" id="alert"><div class="hscysm-model-title"></div><div class="hsycms-model-text">这里是内容</div><div class="hsycms-model-btn"><button type="button ok">前往认证></button></div></div><script type="text/javascript">
        //超时退出
        var uid="";
        var maxTime = 1200; // seconds
        var time = maxTime;
        $('body').on('keydown mousemove mousedown', function(e){
            time = maxTime; // reset
        });
        var intervalId = setInterval(function(){
            time--;
            if(time <= 0) {
                ShowInvalidLoginMessage();
                clearInterval(intervalId);
            }
        }, 1000)
        function ShowInvalidLoginMessage(){
            window.location.href="/index/user/logout.html";
            alert('长时间无操作，自动退出！');
        }
        
        //消息弹窗
        if(uid){
        function xiaoxi_tan() {
            var seeNumUrl = "/index/index/xiaoxi_tan.html";
            $.ajax({
                type : "POST",
                url : seeNumUrl,
                data: {},
                dataType : "json",
                success : function(result){
                    if(result['code'] == 1){
                        $(".alert_windows1").show();
                        document.getElementById("xiaoxi_tan").innerHTML = result['info'];
                    }
                },
                error:function(){
                    //alert();
                }
            });
        }
        }
        $(function(){
            setInterval(xiaoxi_tan, 1000);
        });
        function xiaoxi_close() {
            var seeNumUrl = "/index/index/xiaoxi_close.html";
            $.ajax({
                type : "POST",
                url : seeNumUrl,
                data: {},
                dataType : "json",
            });
            $(".alert_windows1").hide();
        }
        if(uid){
        //通知弹窗
            function tongzhi_tan() {
                var seeNumUrl = "/index/index/tongzhi_tan.html";
                $.ajax({
                    type : "POST",
                    url : seeNumUrl,
                    data: {},
                    dataType : "json",
                    success : function(result){
                        if(result['code'] != 0){
                            $(".alert_windows2").show();
                            document.getElementById("tongzhi_tan").innerHTML = result['code'];
                        }
                    },
                    error:function(){
                        //alert();
                    }
                });
            }
        }
        $(function(){
            setInterval(tongzhi_tan, 1000);
        });
        function tongzhi_close() {
            var seeNumUrl = "/index/index/tongzhi_close.html";
            $.ajax({
                type : "POST",
                url : seeNumUrl,
                data: {},
                dataType : "json",
            });
            $(".alert_windows2").hide();
            setTimeout(function(){
                location.reload();
            },100);
        }
        
        function shiming_alert(txt,txt1){
            $(".hscysm-model-title").text(txt1);
            hsycms.alert('alert',txt,function(){
                hsycms.close('alert');
                location.reload();
                location.href="/index/my/shiming.html"
            })
        }
    </script></head><body class="reg_body"><header class="header" style="background-color: rgba(255,255,255,0);"><a class="goback" href="javascript:history.back();"><img src="http://liulianglianmeng.cn.com/static/images/icon_back.png"></a><h3>修改密码</h3></header><div class="box_bg"></div><form action="" id="forgetpwd-form"><div class="reg_box"><ul><li class="text"><i class="icon_phone"></i><input type="text" name="tel" id="tel" placeholder="请输入邮箱号"></li><!--<li class="text"><i class="icon_invite"></i><input type="text" value="" placeholder="请输入图形验证码" class="input-val" /><canvas id="canvas" width="100" style="float: right;height: 40px;margin-top: 5.5px;" height="43"></canvas></li>--><li class="text"><i class="icon_code"></i><input type="text" name="verify" placeholder="请输入邮箱验证码"><span id="dyMobileButton" class="getcode">获取验证码</span></li><li class="text"><i class="icon_pass"></i><input type="password" name="pwd" id="pwd" placeholder="请输入登录密码"><i class="icon_yan" id="pass"></i></li><li class="text"><i class="icon_pass"></i><input type="password" name="pwd_re" id="pwd_re" placeholder="请再次输入登录密码"><i class="icon_yan" id="cpass"></i></li><li class="submit"><img src="http://liulianglianmeng.cn.com/static/images/editreg.png" style="height:100%;"></li></ul></div></form><script type="application/javascript">
        //密码可见与不可见切换
    	checkPwd("pwd","pass");
		checkPwd("deposit_pwd","cpass");
        function checkPwd(txt,btn){
            var pwd = document.getElementById(txt);
            var btn = document.getElementById(btn);
            var flag = true;
            btn.onclick = function(){
                if(flag){
                    pwd.type="text";
                    flag = false;
                }else{
                    pwd.type="password";
                    flag = true;
                }
            }
        }
        
// 		code_draw();
// 		// 点击后刷新验证码
// 		$("#canvas").on('click', function() {
// 			code_draw();
// 		})
		
		function check_code() {
			// 将输入的内容转为大写，可通过这步进行大小写验证
			var val = $(".input-val").val().toLowerCase();
			// 获取生成验证码值
			var num = $('#canvas').attr('data-code');
			if (val == '') {
				$('body').toast({
        			position:'fixed',
        			content:"请输入图形验证码",
        			duration:3000,
        			isCenter:true,
        			background:'rgba(000,0,0,0.5)',
        			animateIn:'bounceIn-hastrans',
        			animateOut:'bounceOut-hastrans',
        		});
			    return false;
			} else if (val == num) {
				return true;
			} else {
				$('body').toast({
        			position:'fixed',
        			content:"图形验证码错误！请重新输入！",
        			duration:3000,
        			isCenter:true,
        			background:'rgba(000,0,0,0.5)',
        			animateIn:'bounceIn-hastrans',
        			animateOut:'bounceOut-hastrans',
        		});
			    return false;
				$(".input-val").val('');
				draw(show_num);
			}
		}

    
        $(function(){
            var countdown = 60;
            var flag = true;
            var loading = null;
            /*检查表单*/
            function check(){
                if(!check_phone()) return false;
    
                if($("input[name=verify]").val()==''){
                    $('body').toast({
            			position:'fixed',
            			content:"请输入邮箱验证码",
            			duration:3000,
            			isCenter:true,
            			background:'rgba(000,0,0,0.5)',
            			animateIn:'bounceIn-hastrans',
            			animateOut:'bounceOut-hastrans',
            		});
                    return false;
                }
    
                if($("input[name=pwd]").val()==''||$("input[name=pwd_re]").val()==''){
                    $('body').toast({
            			position:'fixed',
            			content:"请输入登录密码",
            			duration:3000,
            			isCenter:true,
            			background:'rgba(000,0,0,0.5)',
            			animateIn:'bounceIn-hastrans',
            			animateOut:'bounceOut-hastrans',
            		});
                    return false;
                }
                if($("input[name=pwd]").val()!==$("input[name=pwd_re]").val()){
                    $('body').toast({
            			position:'fixed',
            			content:"两次输入的密码不一致",
            			duration:3000,
            			isCenter:true,
            			background:'rgba(000,0,0,0.5)',
            			animateIn:'bounceIn-hastrans',
            			animateOut:'bounceOut-hastrans',
            		});
                    return false;
                }
                return true;
            }
    
            /*手机号码验证*/
            function check_phone() {
                if($("input[name=tel]").val()==''){
                    $('body').toast({
            			position:'fixed',
            			content:"请输入邮箱号",
            			duration:3000,
            			isCenter:true,
            			background:'rgba(000,0,0,0.5)',
            			animateIn:'bounceIn-hastrans',
            			animateOut:'bounceOut-hastrans',
            		});
                    return false;
                }
            //     var myreg=/^[1][3,4,5,6,7,8,9][0-9]{9}$/;
            //     if (!myreg.test($("input[name=tel]").val())) {
            //         $('body').toast({
            // 			position:'fixed',
            // 			content:"手机号码输入错误",
            // 			duration:3000,
            // 			isCenter:true,
            // 			background:'rgba(000,0,0,0.5)',
            // 			animateIn:'bounceIn-hastrans',
            // 			animateOut:'bounceOut-hastrans',
            // 		});
            //         return false;
            //     }
                return true;
            }
    
            /*验证码倒计时*/
            function time_down(obj){
                if (countdown == 0) {
                    flag = true;
                    obj.text("获取验证码");
                    countdown = 60;
                    return;
                } else {
                    flag = false;
                    obj.text(countdown+"s") ;
                    countdown--;
                }
                setTimeout(function() {time_down(obj)},1000);
            }
    
            /*获取验证码*/
            $(".getcode").on('click',function(){
                //alert()
                if(check_phone()&&flag){
                    $.ajax({
                        url:'/index/user/send',
                        data: {'tel' : $("input[name=tel]").val(),'type':2},
                        type:'POST',
                        success:function(data){
                            if(data.code==0){
                                $('body').toast({
                        			position:'fixed',
                        			content:data.info,
                        			duration:3000,
                        			isCenter:true,
                        			background:'rgba(000,0,0,0.5)',
                        			animateIn:'bounceIn-hastrans',
                        			animateOut:'bounceOut-hastrans',
                        		});
                                time_down($(".getcode"));
                            }else{
                                $('body').toast({
                        			position:'fixed',
                        			content:data.msg,
                        			duration:3000,
                        			isCenter:true,
                        			background:'rgba(000,0,0,0.5)',
                        			animateIn:'bounceIn-hastrans',
                        			animateOut:'bounceOut-hastrans',
                        		});
                            }
                        }
                    });
                }
            })
    
            /*提交*/
            $(".submit").on('click',function(){
                if(check()){
                    $.ajax({
                        url:"/index/user/do_forget.html",
                        data:$("#forgetpwd-form").serialize(),
                        type:'POST',
                        beforeSend:function(){
                            loading = $(document).dialog({
                                type : 'notice',
                                infoIcon: '/static/images/loading.gif',
                                infoText: "正在加载中",
                                autoClose: 0
                            });
                        },
                        success:function(data){
    
                            if(data.code==0){
                                $(document).dialog({infoText: "修改成功"});
                                setTimeout(function(){
                                    location.href = "/index/user/zhaohui.html"
                                },1500);
                            }else{
                                loading.close();
                                $(document).dialog({infoText: data.info});
                            }
                        }
                    });
                }
    
                return false;
            })
        })
    </script></body></html>